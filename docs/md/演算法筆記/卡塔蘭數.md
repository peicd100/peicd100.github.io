# 卡塔蘭數


**第0項到第19項的卡塔蘭數為**：             
1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190




## 公式


/// html | div.i

[from wiki](https://zh.m.wikipedia.org/wiki/%E5%8D%A1%E5%A1%94%E5%85%B0%E6%95%B0)     

$$
C_n = \frac{1}{n+1} \binom{2n}{n} = \frac{(2n)!}{(n+1)!n!}
$$

---

$$
其中，\binom{2n}{n} = \frac{(2n)!}{n!(2n-n)!} = \frac{(2n)!}{n!n!}
$$

///




## 應用

1. $C_n$ 表示長度 $2n$ 的 [dyck word](https://en.wikipedia.org/wiki/Dyck_language) 的個數。Dyck 詞是一個有 $n$ 個 X 和 $n$ 個 Y 組成的字串，且所有的前綴字串皆滿足 X 的個數大於等於 Y 的個數。以下為長度為 6 的 dyck words：    
XXYYYY XYXXYY XYXYXY XXYYXY
2. 將上例的 X 換成左括號，Y 換成右括號，$C_n$ 表示所有包含 $n$ 組括號的合法運算式的個數：   
((())) 、 ()(()) 、 ()()() 、 (())() 、 (()())
3. $C_n$ 表示有 $n$ 個節點組成不同構二元樹的方案數。下圖中，$n = 3$，圓形表示節點，月牙形表示什麼都沒有。   
4. $C_n$ 表示不含 $2n + 1$ 個節點組成不同構滿二元樹的方案數。下圖中，$n = 3$，圓形表示內部節點，月牙形表示外部節點。本質同上。     
![alt text](../images/卡塔蘭數/image-10.png)     
    **證明**：令 1 表示連接，0 表示不連接，則可轉化為求一個 $2n$ 位、含 $n$ 個 1、$n$ 個 0 的二進制數，滿足從左往右掃描到任意一位時，經過的 0 數不多於 1 數。顯然含 $n$ 個 1、$n$ 個 0 的 $2n$ 位二進制數共有 $ \binom{2n}{n} $ 個，下面考慮不滿足要求的數目。         

    考慮一個含 $n$ 個 1、$n$ 個 0 的 $2n$ 位二進制數，掃描到第 $2m + 1$ 位上時有 $m + 1$ 個 0 和 $m$ 個 1（容易證明一定存在這樣的情況），則後面的 0-1 排列中必有 $n - m$ 個 1 和 $n - m - 1$ 個 0。將 $2m + 2$ 及其以後的部分 $0$ 變成 1、1 變成 0，則對應一個 $n + 1$ 個 0 和 $n - 1$ 個 1 的二進制數。反之亦然（相似的思路證明兩者一一對應）。        

    從而 $C_n = \binom{2n}{n} - \binom{2n}{n+1} = \frac{1}{n+1} \binom{2n}{n}$ 證畢。

5. $C_n$ 表示所有在 $n \times n$ 棋盤中不越過對角線的單調路徑的個數。一個單調路徑從左下角出發，在右上角結束，每一步均為向上或向右。計算這種路徑的個數等價於計算 Dyck word 的個數：X 代表「向右」，Y 代表「向上」。下圖為 $n = 4$ 的情況：

![alt text](../images/卡塔蘭數/image-11.png)   
6.  $C_n$ 表示通過連結頂點將 $n + 2$ 邊的凸多邊形分成三角形的方法個數。下圖中為 $n = 4$ 的情況：   
![alt text](../images/卡塔蘭數/image-12.png)    
7. $C_n$ 表示對 $\{1, \dots, n\}$ 位序進出樣的置換個數。一個置換 $w$ 是依序進出的當 $S(w) = (1, \dots, n)$，其中 $S(w)$ 遞歸定義如下：令 $w = unv$，其中 $n$ 為 $w$ 的最大元素，$u$ 和 $v$ 為更短的數列；再令 $S(w) = S(u)S(v)n$，其中 $S$ 滿所有含 $n$ 個元素的數列的單位元。     
8. $C_n$ 表示集合 $\{1, \dots, n\}$ 的 **不交叉圖分** 的個數。那麼，$C_n$ 永遠不大於第 $n$ 項的項目數，$C_n$ 也表示集合 $\{1, \dots, 2n\}$ 的 **不交叉圖分** 的個數，其中每個圖段落的長度為 2。綜合這兩個組合，可以用數學歸納法證明：在幾格格半固分的情形下，所有 **自由的累積量** 為零。設定律在自由的概義論和隨機矩陣理論中的非常重要。    
9. $C_n$ 表示不用 $n$ 個長方形填充一個高為 $n$ 的階梯狀長方形的方法個數。下圖為 $n = 4$ 的情況：        
![alt text](../images/卡塔蘭數/image-13.png)    
10. $C_n$ 表示為 $2 \times n$ 的矩陣的標準 **楊氏矩陣** 的數量。也就是說，它是數字 $1, 2, \dots, 2n$ 被放置在一個 $2 \times n$ 的矩形中，並保證每行每列的數字升序排列的方案數。同樣的，該式可由 **勾長公式** 的一個特殊情形推導得出。
11. $C_n$ 表示 $n$ 個無標號物品的 **半序** 的個數。


## 例題
[e876. Q1 - 配對連線](https://zerojudge.tw/ShowProblem?problemid=e876)


[a229. 括號匹配問題](https://zerojudge.tw/ShowProblem?problemid=a229)


[d837. NOIP2003 3.栈](https://zerojudge.tw/ShowProblem?problemid=d837)